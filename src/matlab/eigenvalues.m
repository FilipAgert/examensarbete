%eig = [1.0000000147759371       0.99996282169991801       0.99997690069335010       0.99991230483435101       0.99988968601160300       0.99985955732142329       0.99995374065172082       0.99988822602672434       0.99977979156123553       0.99970662137672228       0.99979534930547365       0.99978099473814619       0.99976123463151412       0.99967199892226344       0.99965907455946001       0.99965009393114845       0.99969654979977385       0.99956377030118115       0.99958249428926949       0.99962491447964341       0.99958837565785841       0.99946782980923721       0.99945044192041943       0.99941010406770081       0.99930350331533357       0.99945279761783901       0.99942794404782631       0.99943060439445308       0.99939767135368451       0.99925747791175190       0.99931904996273746       0.99920351191423906       0.99925526742463988       0.99916551593022152       0.99919273813497922       0.99911267527260716       0.99905829619864062       0.99919148733765883       0.99918748834901305       0.99907214766463581       0.99897860809391870       0.99894943740342212       0.99899250062304001       0.99884493924546613       0.99889493109476657       0.99891114771629952       0.99890416563986795       0.99890536060426094       0.99883970279308743       0.99879103078697018    ] ;
%eig = eig*-1 + max(eig) +1e-10;
%plot(eig)

%for N = 90601
clear
close all
Ns = [600*600, 1000*1000, 2000*2000];%, 1000*1000];
t = [28, 130, 1128];
t2 = [41, 192,2315];
x0 = [1, 1];
x1 = [1, 1.5];
F = @(x, N) x(1)*N + x(2)*N.^2;
G = @(x,N) x(1)*N.^x(2);
linsys = lsqcurvefit(F, x0, Ns, t);
arnoldi = lsqcurvefit(F, x0, Ns, t2);
linsys2 = lsqcurvefit(G,x1, Ns,t);

Nspace = linspace(100*100,10e6,100);
loglog(Nspace, F(linsys,Nspace), 'b');
hold on
loglog(Nspace, F(arnoldi,Nspace), 'r')
loglog(Ns, t, 'ob')
loglog(Ns, t2, 'or')
loglog(Nspace, G(linsys2, Nspace), 'g')

ExpectedTimeLinsys = F(linsys, 8e6)
ExpectedLinsys2 = G(linsys2,8e6)